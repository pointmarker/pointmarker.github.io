<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <link rel="icon" href="svg.svg" type="image/svg+xml">
    <title>O Mu Bu mu</title>
</head>
<body>
    <main>
        <div id="screen">
            <div id="flu-header-div">
                <svg id="flu-header" version="1.1" xmlns="http://www.w3.org/2000/svg" style="display: block;" viewBox="0 0 2048 852" width="660"
                    height="120" preserveAspectRatio="none">
                    <!-- <path transform="translate(0,0)" fill="rgb(255,188,11)" d="M 0 0 L 2048 0 L 2048 852 L 0 852 L 0 0 z"/> -->
                    <path class="flu-header-color" transform="translate(0,0)" fill="rgb(255,188,11)"
                        d="M 1434.77 279.857 C 1464.29 279.83 1499.26 280.792 1528.25 279.342 C 1527.35 308.632 1528.01 340.98 1527.99 370.5 C 1527.98 442.985 1526.32 522.966 1528.41 594.895 L 1211.1 595.039 C 1210.29 527.522 1210.95 458.671 1210.94 391.042 L 1210.84 321.197 C 1210.81 308.8 1210.38 291.413 1211.37 279.464 C 1221.05 280.239 1236.14 279.828 1246.07 279.822 L 1306.16 279.922 C 1305.67 329.203 1305.54 378.486 1305.79 427.768 C 1305.79 450.337 1306.6 479.542 1305.19 501.559 L 1434.93 501.267 C 1435.52 478.976 1434.78 453.481 1434.77 430.819 L 1434.77 279.857 z" />
                    <path class="flu-header-color" transform="translate(0,0)" fill="rgb(255,188,11)"
                        d="M 444.704 279.688 C 550.346 281.096 657.574 279.345 763.434 279.904 C 761.625 306.109 762.673 345.791 763.048 372.796 C 726.89 371.033 688.869 372.999 652.388 371.81 C 647.296 387.166 645.045 406.393 641.541 422.646 C 639.112 433.908 639.056 451.944 633.995 462.342 C 633.316 463.738 633.76 464.338 634.066 466.145 L 635.277 466.807 L 634.79 468.138 C 629.69 469.612 606.538 469.033 600.191 469.014 L 538.054 468.945 C 538.035 510.942 538.315 552.938 538.896 594.931 C 507.518 594.744 476.14 594.866 444.765 595.296 C 443.842 550.611 444.408 504.232 444.383 459.366 C 444.166 399.473 444.273 339.579 444.704 279.688 z" />
                    <path class="flu-header-color" transform="translate(0,0)" fill="rgb(255,188,11)"
                        d="M 920.272 279.551 L 920.877 279.914 C 922.534 282.968 921.607 479.851 921.794 501.586 C 977.14 502.496 1032.92 500.914 1088.32 501.505 C 1107.03 501.705 1126.49 501.716 1145.14 500.724 C 1145.09 528.255 1143.92 568.157 1145.96 594.982 L 1056.5 594.845 C 980.495 594.831 902.868 594.091 827.012 595.195 L 827.028 279.861 C 858.11 280.026 889.192 279.922 920.272 279.551 z" />
                </svg>
                <div class="love">
                    <input id="switch" type="checkbox">
                    <label class="love-heart" for="switch">
                      <i class="left"></i>
                      <i class="right"></i>
                      <i class="bottom"></i>
                      <div class="round"></div>
                    </label>
                </div>
                
            </div>
            
        </div>
        <div id="menu">
            <div id="create-game" class="menu-option plus">
                <svg fill="rgba(233,217,211,0.4)" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" id="plus" width="48" height="48" version="1.1" viewBox="0 0 64 64">
                    <path stroke="rgba(233,217,211,0.4)" d="M32 0C23.452 0 15.416 3.33 9.373 9.374 3.328 15.417-.001 23.453-.001 32s3.329 16.583 9.374 22.626C15.416 60.671 23.452 64 32 64c8.547 0 16.583-3.33 22.627-9.374 6.045-6.044 9.374-14.079 9.374-22.626s-3.329-16.583-9.374-22.626C48.583 3.329 40.547 0 32 0zm19.799 51.798C46.51 57.087 39.479 60 32 60c-7.479 0-14.511-2.913-19.799-8.203C6.912 46.509 3.999 39.479 3.999 32s2.913-14.509 8.202-19.798C17.489 6.913 24.521 4 32 4c7.479 0 14.51 2.913 19.799 8.203 5.289 5.288 8.202 12.319 8.202 19.797s-2.913 14.509-8.202 19.798z"></path>
                    <path stroke="rgba(233,217,211,0.4)" d="M50 30H34V14a2 2 0 0 0-4 0v16H14a2 2 0 0 0 0 4h16v16a2 2 0 0 0 4 0V34h16a2 2 0 0 0 0-4z"></path>
                </svg>
            </div>
            <div id="projects-btn" class="menu-option layers">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" id="layers">
                    <g id="Page-1" fill="none" fill-rule="evenodd" stroke="rgba(233,217,211,0.4)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
                      <g id="Artboard" stroke="rgba(233,217,211,0.4)" stroke-width="2" transform="translate(-1686 -1691)">
                        <g stroke="rgba(233,217,211,0.4)" id="layers" transform="translate(1687 1692)">
                          <path stroke="rgba(233,217,211,0.4)" id="Shape" d="M10 0 0 5l10 5 10-5zM0 15l10 5 10-5M0 10l10 5 10-5"></path>
                        </g>
                      </g>
                    </g>
                  </svg>
            </div>
        </div>
    </main>
    <script>
        const main = document.querySelector('main')
        const html = document.querySelector('html')
        const menu = document.getElementById('menu')
        const fluHeaderColor = document.getElementsByClassName('flu-header-color')
        const fluHeaderDiv = document.getElementById('flu-header-div')
        const exitBtnColor = document.getElementById('exit-btn-color')
        const screen = document.getElementById('screen')
        
        let gameState = "create"

        let gameObj = {}

        /* THEME LOGIC */
        const loveBtn = document.getElementsByClassName('love')
        loveBtn[0].addEventListener('change', (e) => {

            const gameTypes = document.getElementsByClassName('game-type')
            const rivalsElement = document.getElementsByClassName('rivals-element')
            const entries = document.getElementById('entries')
            const menuOptions = document.getElementsByClassName('menu-option')
            const projects = document.getElementById('projects')
            const gameInfos = document.getElementById('game-infos-div')

            if(e.target.checked){
                html.style.backgroundColor = 'rgb(255,188,11)'
                for(path of fluHeaderColor){
                    path.style.fill = 'rgb(33, 31, 31)'
                }
                if(exitBtnColor) exitBtnColor.style.fill = 'rgb(33, 31, 31)'

                if(gameTypes){
                    for(const type of gameTypes){
                        const pEl = type.querySelector('p')
                        if(pEl) pEl.style.color = "rgb(33,31,31)"
                    }
                }

                if(rivalsElement.length){
                    if(entries){
                        const projectNameLabel = document.getElementById('game-name-div').querySelector('label')
                        projectNameLabel.style.color = 'rgb(33,31,31)'
                        entries.style.borderColor = 'rgba(233,217,211,0.8)'
                    } 
                    for(const rivalEl of rivalsElement){
                        const forms = rivalEl.querySelectorAll('form')
                        for(const form of forms){
                            const labels = form.querySelectorAll('label')
                            for(const label of labels){
                                label.style.color = "rgb(33,31,31)"
                            }
                            
                            const inputs = form.querySelectorAll('input')
                            for(const input of inputs){
                                if(input.type !== "text"){
                                    input.style.color = "rgb(33,31,31)"
                                }
                            }
                        }
                    }
                }
                else if(entries){
                    const projectNameLabel = document.getElementById('game-name-div').querySelector('label')
                    projectNameLabel.style.color = 'rgb(33,31,31)'
                    entries.style.borderColor = 'rgba(233,217,211,0.8)'
                    console.log(entries.style.borderColor)
                    const forms = entries.querySelectorAll('form')
                        for(const form of forms){
                            const labels = form.querySelectorAll('label')
                            for(const label of labels){
                                label.style.color = "rgb(33,31,31)"
                            }
                            
                            const inputs = form.querySelectorAll('input')
                            for(const input of inputs){
                                if(input.type !== "text"){
                                    input.style.color = "rgb(33,31,31)"
                                }
                            }
                        }
                }
                
                if(menuOptions.length){
                    for(const opt of menuOptions){
                        const svg = opt.querySelector('svg')
                        const allPath = opt.querySelectorAll('path')
                        const allG = opt.querySelectorAll('g')

                        svg.style.transition = "0.3s ease"
                        svg.style.fill = 'rgba(33,31,31,0.4)'
                        allPath.forEach(path =>{
                            path.style.transition = "0.3s ease"
                            path.style.stroke = 'rgba(33,31,31,0.4)'
                        } )
                        allG.forEach(g =>{
                            g.style.transition = "0.3s ease"
                            g.style.stroke = 'rgba(33,31,31,0.4)'
                        })
                    }
                }

                if(gameInfos){
                    const pEl = gameInfos.querySelector('p')
                    const labelEl = gameInfos.querySelector('label')

                    if(pEl) pEl.style.color = 'rgb(33,31,31)'
                    if(labelEl) labelEl.style.color = 'rgb(33,31,31)'

                }
                if(projects){
                    const delBtns = document.getElementsByClassName('project-delete-button')
                    const modes = document.getElementsByClassName('project-mode')
                    const names = document.getElementsByClassName('project-name')
                    const dates = document.getElementsByClassName('project-date')
                    const warning = document.getElementById('projects-warning-text')

                    warning.style.color = 'rgb(33,31,31)'

                    for(const btn of delBtns){
                        const svg = btn.querySelector('svg')
                        const path = btn.querySelector('path')

                        svg.style.transition = "0.3s ease"
                        path.style.transition = "0.3s ease"
                        svg.style.fill = 'rgba(33,31,31,0.4)'
                        path.style.stroke = 'rgba(33,31,31,0.4)'
                    }

                    for(const mode of modes){mode.style.color = 'rgba(33,31,31,0.8)'}
                    for(const name of names){name.style.color = 'rgb(33,31,31)'}
                    for(const date of dates){date.style.color = 'rgba(33,31,31,0.4)'}
                }
            }else{
                html.style.backgroundColor = 'rgb(33, 31, 31)'
                for(path of fluHeaderColor){
                    path.style.fill = 'rgb(255,188,11)'
                }
                if(exitBtnColor) exitBtnColor.style.fill = 'rgb(237, 228, 228)'

                if(gameTypes){
                    for(const type of gameTypes){
                        const pEl = type.querySelector('p')
                        if(pEl) pEl.style.color = "rgb(237, 228, 228)"
                    }
                }

                if(rivalsElement.length){
                    if(entries){
                        const projectNameLabel = document.getElementById('game-name-div').querySelector('label')
                        projectNameLabel.style.color = 'rgb(233,217,211)'
                        entries.style.borderColor = 'rgba(233,217,211,0.2)'
                    }
                    for(const rivalEl of rivalsElement){
                        const forms = rivalEl.querySelectorAll('form')
                        for(const form of forms){
                            const labels = form.querySelectorAll('label')
                            for(const label of labels){
                                label.style.color = "rgb(237,228,228)"
                            }
                            
                            const inputs = form.querySelectorAll('input')
                            for(const input of inputs){
                                if(input.type !== "text"){
                                    input.style.color = "rgb(237,228,228)"
                                }
                            }
                            
                        }
                    }
                }
                else if(entries){
                    const projectNameLabel = document.getElementById('game-name-div').querySelector('label')
                    projectNameLabel.style.color = 'rgb(233,217,211)'
                    entries.style.borderColor = 'rgba(233,217,211,0.2)'
                    console.log(entries.style.borderColor)
                    const forms = entries.querySelectorAll('form')
                        for(const form of forms){
                            const labels = form.querySelectorAll('label')
                            for(const label of labels){
                                label.style.color = "rgb(237,228,228)"
                            }
                            
                            const inputs = form.querySelectorAll('input')
                            for(const input of inputs){
                                if(input.type !== "text"){
                                    input.style.color = "rgb(237,228,228)"
                                }
                            }
                            
                        }
                }

                if(menuOptions.length){
                    for(const opt of menuOptions){
                        const svg = opt.querySelector('svg')
                        const allPath = opt.querySelectorAll('path')
                        const allG = opt.querySelectorAll('g')

                        svg.style.transition = "0.3s ease"
                        svg.style.fill = 'rgba(233,217,211,0.4)'
                        allPath.forEach(path =>{
                            path.style.transition = "0.3s ease"
                            path.style.stroke = 'rgba(233,217,211,0.4)'
                        } )
                        allG.forEach(g =>{
                            g.style.transition = "0.3s ease"
                            g.style.stroke = 'rgba(233,217,211,0.4)'
                        })
                    }
                }

                if(gameInfos){
                    const pEl = gameInfos.querySelector('p')
                    const labelEl = gameInfos.querySelector('label')

                    pEl.style.color = 'rgb(233,211,211)'
                    labelEl.style.color = 'rgb(233,211,211)'

                }
                if(projects){
                    const delBtns = document.getElementsByClassName('project-delete-button')
                    const modes = document.getElementsByClassName('project-mode')
                    const names = document.getElementsByClassName('project-name')
                    const dates = document.getElementsByClassName('project-date')  
                    const warning = document.getElementById('projects-warning-text')

                    warning.style.color = 'rgb(233,217,211)'   

                    for(const btn of delBtns){
                        const svg = btn.querySelector('svg')
                        const path = btn.querySelector('path')

                        svg.style.transition = "0.3s ease"
                        path.style.transition = "0.3s ease"
                        svg.style.fill = 'rgba(237, 228, 228,0.4)';
                        path.style.stroke = 'rgba(237, 228, 228,0.4)';
                    }

                    for(const mode of modes){mode.style.color = 'rgba(237, 228, 228,0.8)'}
                    for(const name of names){name.style.color = 'rgb(237, 228, 228)'}
                    for(const date of dates){date.style.color = 'rgba(237, 228, 228,0.4)'}
                    
                }
            }
        })

        menu.addEventListener('mouseover', (e) => {
            const checked = document.getElementById('switch').checked
            const targetDiv = e.target.closest('div')
            if(targetDiv.className.split(" ").includes('menu-option')){
                const svg = targetDiv.querySelector('svg')
                const allPath = targetDiv.querySelectorAll('path')
                const allG = targetDiv.querySelectorAll('g')

                svg.style.transition = "0.3s ease"
                svg.style.fill = checked ? 'rgba(33,31,31,1)' :  'rgba(233,217,220,1)'
                allPath.forEach(path =>{
                    path.style.transition = "0.3s ease"
                    path.style.stroke = checked ? 'rgba(33,31,31,1)' :  'rgba(233,217,220,1)'
                } )
                allG.forEach(g =>{
                    g.style.transition = "0.3s ease"
                    g.style.stroke = checked ? 'rgba(33,31,31,1)' :  'rgba(233,217,220,1)'
                })
            }
        })

        menu.addEventListener('mouseout', (e) => {

            const checked = document.getElementById('switch').checked
            const targetDiv = e.target.closest('div')
            if(targetDiv.className.split(" ").includes('menu-option')){
                const svg = targetDiv.querySelector('svg')
                const allPath = targetDiv.querySelectorAll('path')
                const allG = targetDiv.querySelectorAll('g')

                svg.style.transition = "0.3s ease"
                svg.style.fill = checked ? 'rgba(33,31,31,0.5)' :  'rgba(233,217,220,0.4)'
                allPath.forEach(path =>{
                    path.style.transition = "0.3s ease"
                    path.style.stroke = checked ? 'rgba(33,31,31,0.5)' :  'rgba(233,217,220,0.4)'
                } )
                allG.forEach(g =>{
                    g.style.transition = "0.3s ease"
                    g.style.stroke = checked ? 'rgba(33,31,31,0.5)' :  'rgba(233,217,220,0.4)'
                })
            }
        })
        
        menu.addEventListener('click', (e) => {
            const targetDiv = e.target.closest('div')
            const targetDivClass = targetDiv.className.split(' ')
            if(targetDivClass[0] ==='menu-option'){
                switch (targetDivClass[1]) {
                    case "plus":
                        createGame()
                        break;
                    case "layers":
                        showProjects()
                        break;

                    default:
                        break;
                }
            }
        })

        async function showProjects(){

            const gameDiv = document.getElementById('projects')
            gameDiv && gameDiv.remove()

            const game = document.getElementById('game')
            game && game.remove()

            const projects = await getProjectsAsObject()

            const projectsDiv = document.createElement('div')
            projectsDiv.id = 'projects'

            projectsDiv.addEventListener('click', (e) => {
                console.log('basıldı')
                const parentElement = e.target.parentElement

                console.log({parentElement})
                if(parentElement.className === "project-infos" || parentElement.className === "project-div" || parentElement.id === "projects" ){
                    console.log('ife girdi')
                    let targetDiv; 
                    if(parentElement.className === "project-infos") targetDiv = parentElement.closest('.project-div')
                    else if(parentElement.id === "projects") targetDiv = parentElement.querySelector('.project-div')
                    else if(parentElement.className === "project-div") targetDiv = parentElement
                    
                    console.log('hangisi olduğunu seçti')
                    const targetKey = targetDiv.getAttribute('key')
                    console.log('targetKeyi aldı')
                    const targetObj = projects[targetKey]
                    console.log('targetObj yaratıldı')

                    createGame(targetObj,targetKey)
                    console.log('oyun açıldı')
                }
            })


            const checked = document.getElementById('switch').checked

            Object.entries(projects).forEach(([key,value]) => {
                const {obj, name, mode} = value

                const projectDiv = document.createElement('div')
                projectDiv.className = "project-div"
                projectDiv.setAttribute('key', key)

                const projectInfosDiv = document.createElement('div')
                projectInfosDiv.className = "project-infos"

                const projectNamePEl = document.createElement('p')
                projectNamePEl.className = "project-name"
                projectNamePEl.textContent = name
                projectNamePEl.style.color = checked ? "rgb(33,31,31)" : "rgb(233,217,222)"
                

                const projectModePEl = document.createElement('p')
                projectModePEl.className = "project-mode"
                projectModePEl.style.color = checked ? "rgba(33,31,31,0.8)" : "rgba(233,217,222,0.8)"
                
                projectModePEl.textContent = mode === "Random" ? "R" : "M"

                const projectDatePEl = document.createElement('p')
                projectDatePEl.className = "project-date"
                projectDatePEl.style.color = checked ? "rgba(33,31,31,0.4)" : "rgba(233,217,222,0.4)"
                projectDatePEl.textContent = key

                projectInfosDiv.appendChild(projectModePEl)
                projectInfosDiv.appendChild(projectNamePEl)
                projectInfosDiv.appendChild(projectDatePEl)
                
                const deleteBtnDiv = document.createElement('div')
                deleteBtnDiv.className = "project-delete-button"

                deleteBtnDiv.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" height="32" width="32" id="delete">
                        <path d="M24.2,12.193,23.8,24.3a3.988,3.988,0,0,1-4,3.857H12.2a3.988,3.988,0,0,1-4-3.853L7.8,12.193a1,1,0,0,1,2-.066l.4,12.11a2,2,0,0,0,2,1.923h7.6a2,2,0,0,0,2-1.927l.4-12.106a1,1,0,0,1,2,.066Zm1.323-4.029a1,1,0,0,1-1,1H7.478a1,1,0,0,1,0-2h3.1a1.276,1.276,0,0,0,1.273-1.148,2.991,2.991,0,0,1,2.984-2.694h2.33a2.991,2.991,0,0,1,2.984,2.694,1.276,1.276,0,0,0,1.273,1.148h3.1A1,1,0,0,1,25.522,8.164Zm-11.936-1h4.828a3.3,3.3,0,0,1-.255-.944,1,1,0,0,0-.994-.9h-2.33a1,1,0,0,0-.994.9A3.3,3.3,0,0,1,13.586,7.164Zm1.007,15.151V13.8a1,1,0,0,0-2,0v8.519a1,1,0,0,0,2,0Zm4.814,0V13.8a1,1,0,0,0-2,0v8.519a1,1,0,0,0,2,0Z"></path>
                    </svg>
                `

                const deleteDiv = deleteBtnDiv.closest('div').className === "project-delete-button" && deleteBtnDiv.closest('div')

                if(deleteDiv){
                    const svg = deleteDiv.querySelector('svg')
                    const path = deleteDiv.querySelector('path')

                    svg.style.transition = "0.3s ease"
                    path.style.transition = "0.3s ease"
                    svg.style.fill = checked ? 'rgba(33,31,31,0.4)' : 'rgba(237, 228, 228,0.4)';
                    path.style.stroke = checked ? 'rgba(33,31,31,0.4)' : 'rgba(237, 228, 228,0.4)';  
                }
             
                

                deleteBtnDiv.addEventListener('mouseover', (e) => {
                    const checked = document.getElementById('switch').checked
                    const deleteDiv = e.target.closest('div').className === "project-delete-button" && e.target.closest('div')

                    const svg = deleteDiv.querySelector('svg')
                    const path = deleteDiv.querySelector('path')

                    svg.style.transition = "0.3s ease"
                    path.style.transition = "0.3s ease"
                    svg.style.fill = checked ? 'rgb(33,31,31)' : 'rgb(237, 228, 228)';
                    path.style.stroke = checked ? 'rgb(33,31,31)' : 'rgb(237, 228, 228)';   
                })
                deleteBtnDiv.addEventListener('mouseout', (e) => {
                    const checked = document.getElementById('switch').checked
                    const deleteDiv = e.target.closest('div').className === "project-delete-button" && e.target.closest('div')
                    
                    const svg = deleteDiv.querySelector('svg')
                    const path = deleteDiv.querySelector('path')

                    svg.style.transition = "0.3s ease"
                    path.style.transition = "0.3s ease"
                    svg.style.fill = checked ? 'rgba(33,31,31,0.4)' : 'rgba(237, 228, 228,0.4)';
                    path.style.stroke = checked ? 'rgba(33,31,31,0.4)' : 'rgba(237, 228, 228,0.4)';
                })

                deleteBtnDiv.addEventListener('click', (e) => {
                    const parent = e.target.closest('div').parentElement
                    const objKey = parent.querySelector('.project-date').textContent
                    deleteAreYouSure(objKey)
                })
                
                projectDiv.appendChild(projectInfosDiv)
                projectDiv.appendChild(deleteBtnDiv)

                projectsDiv.appendChild(projectDiv)
            })

            screen.appendChild(projectsDiv)

            
            if(!Object.keys(projects).length){
                const warningPEl = document.createElement('p')
                warningPEl.textContent = "There is no saved project."
                warningPEl.style.color = checked ? 'rb(33,31,31)' : 'rgb(233,217,217)'
                warningPEl.id = "projects-warning-text"
                projectsDiv.appendChild(warningPEl)
            }
            
        }
        function createGame(createdObj,objKey){
            let game = document.getElementById('game')
            if(game) game.remove()

            const projects = document.getElementById('projects')
            if(projects) projects.remove()

            game = document.createElement('div')
            game.id= "game"

            screen.appendChild(game)

            const gameScreen = document.createElement('div')
            gameScreen.id = "game-screen"

            const checked = document.getElementById('switch').checked

            const entries = document.createElement('div')
            entries.style.borderColor = checked ? "rgba(233,217,217,0.8)" : 'rgba(233,217,211,0.2)'
            entries.id = "entries"

            const gameInfosDiv = document.createElement('div')
            gameInfosDiv.id = "game-infos-div"

            

            const gameNameDiv = document.createElement('div')
            gameNameDiv.id = "game-name-div"
            const gameNameInput = document.createElement('input')
            gameNameInput.id = "game-name-input"
            const gameNameLabel = document.createElement('label')
            gameNameLabel.htmlFor = "game-name-input"
            gameNameLabel.textContent = "Project Name"
            gameNameLabel.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233, 217, 211)'

            gameNameDiv.appendChild(gameNameLabel)
            gameNameDiv.appendChild(gameNameInput)

            // const gameModeDiv = document.createElement('div')
            // gameModeDiv.id = "game-mode-div"
            // gameModeDiv.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233, 217, 211)'
            // const gameModeNameEl = document.createElement('p')

            // gameModeDiv.appendChild(gameModeNameEl)

            gameInfosDiv.appendChild(gameNameDiv)

            gameScreen.appendChild(gameInfosDiv)
            gameScreen.appendChild(entries)

            if(createdObj){
                const {obj,mode,name} = createdObj
                gameNameInput.value = name
                switch (mode) {
                    case "Random":
                        randomMenu(obj,objKey)
                        break;
                    case "Manuel":
                        manuelMenu(obj,objKey)
                        break;
                
                    default:
                        break;
                }

                game.appendChild(gameScreen)
                return
            }
            

            function createInputForm(obj){

                let img, text;
                if(obj){
                    img = obj.img;
                    text = obj.text
                }

                const checked = document.getElementById('switch').checked
                const imageDiv = document.createElement('div')

                imageDiv.style.display = "none"
                imageDiv.style.position = "relative"

                const imageEl = document.createElement('img')
                imageEl.style.maxWidth = "100px"

                const imageInputDiv = document.createElement('div')
                imageInputDiv.className = "image-input-div"

                if(img){
                    imageEl.src = img
                    imageDiv.style.display = "block"
                    imageInputDiv.style.display = 'none'
                }

                const deleteImgBtn = document.createElement('div')
                const deleteSvg = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="10px" height="10px" id="close">
                        <path d="M15.71,8.29a1,1,0,0,0-1.42,0L12,10.59,9.71,8.29A1,1,0,0,0,8.29,9.71L10.59,12l-2.3,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L12,13.41l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L13.41,12l2.3-2.29A1,1,0,0,0,15.71,8.29Zm3.36-3.36A10,10,0,1,0,4.93,19.07,10,10,0,1,0,19.07,4.93ZM17.66,17.66A8,8,0,1,1,20,12,7.95,7.95,0,0,1,17.66,17.66Z"></path>
                    </svg>
                `
                deleteImgBtn.id = "delete-img-btn"
                deleteImgBtn.innerHTML = deleteSvg

                deleteImgBtn.addEventListener('click', (e) => {
                    imageEl.removeAttribute('src')
                    imageDiv.style.display = 'none'
                    imageInputDiv.style.display = "flex"
                    inputImage.value = ""
                    inputImage.style.display = 'block'
                })

                imageDiv.appendChild(imageEl)
                imageDiv.appendChild(deleteImgBtn)

                const inputImage = document.createElement('input')
                inputImage.className = "input-image"
                inputImage.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233,217,220)'
                inputImage.type= "file"
                inputImage.id = "input-image-"
                inputImage.accept= "image/png, image/jpeg"

                const labelImage = document.createElement('label')
                labelImage.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233,217,220)'
                labelImage.textContent = "Add Image"
                labelImage.htmlFor = "input-image-"

               
                imageInputDiv.appendChild(labelImage)
                imageInputDiv.appendChild(inputImage)

                const inputDescp = document.createElement('textarea')
                inputDescp.rows = 2
                inputDescp.wrap = "soft"
                inputDescp.className = "input-descp"
                inputDescp.type = "text"
                inputDescp.id = "input-text-"
                if(text) inputDescp.value = text

                const labelDescp = document.createElement('label')
                labelDescp.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233,217,220)'
                labelDescp.textContent = "Description"
                labelDescp.htmlFor = "input-text-"

                const descpDiv = document.createElement('div')
                descpDiv.className = "descp-div"

                descpDiv.appendChild(labelDescp)
                descpDiv.appendChild(inputDescp)

                const inputForm = document.createElement('form')
                inputForm.className= "input-form"
                inputForm.onsubmit = (e) => e.preventDefault() 

                inputForm.appendChild(imageInputDiv)
                inputForm.appendChild(imageDiv)
                inputForm.appendChild(descpDiv)

                inputImage.onchange = async(e) => {
                    const file = inputImage.files && inputImage.files[0]

                    const url = URL.createObjectURL(file)
                    const imgBase64 = await blobUrlToBase64(url)

                    imageEl.src = imgBase64

                    imageEl.onload = () => URL.revokeObjectURL(url);
                    
                    imageDiv.style.display = "block"
                    imageInputDiv.style.display = 'none'

                }

                return inputForm
            }

            const gameTypeSelectionDiv = document.createElement('div')
            gameTypeSelectionDiv.id = "game-type-selection"

            const randomDiv = document.createElement('div')
            randomDiv.className = "game-type"
            const randomPEl = document.createElement('p')
            randomPEl.innerText = 'Random'
            randomPEl.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233,217,217)'
            randomDiv.appendChild(randomPEl)

            const manuelDiv = document.createElement('div')
            manuelDiv.className = "game-type"
            const manuelPEl = document.createElement('p')
            manuelPEl.innerText = 'Manuel'
            manuelPEl.style.color = checked ? 'rgb(33,31,31)' : 'rgb(233,217,217)'
            manuelDiv.appendChild(manuelPEl)

            gameTypeSelectionDiv.appendChild(manuelDiv)
            gameTypeSelectionDiv.appendChild(randomDiv)

            game.appendChild(gameTypeSelectionDiv)
            game.appendChild(gameScreen)

            function randomMenu(obj,objKey){

                const randomBtn = document.getElementsByClassName('game-type')
                if(randomBtn.length){
                    randomBtn[0].style.outline = 'none'
                    randomBtn[1].style.outline = "2px solid rgb(233,217,211)"
                }
                
                const manuelDiv = document.getElementById('manuel-div')
                manuelDiv && manuelDiv.remove()
                const random = document.getElementById('random-div')
                if(random) return;

                entries.style.display = "flex"
                entries.innerHTML = ""

                if(obj){
                    Object.entries(obj).forEach(([key,value]) => {
                        entries.appendChild(createInputForm(obj[key]))
                    })
                }else{
                    entries.appendChild(createInputForm())
                    entries.appendChild(createInputForm())
                }

                const addLineBtn = document.createElement('button')
                addLineBtn.className = "add-btn"
                addLineBtn.textContent = "Add Line"
                addLineBtn.onclick = () =>{
                    entries.appendChild(createInputForm())
                } 
            
                const removeLineBtn = document.createElement('button')
                removeLineBtn.className = "remove-btn"
                removeLineBtn.textContent = "Remove Line"
                removeLineBtn.onclick = () => {
                    const inputEls = entries.querySelectorAll('.input-form') 
                    if(inputEls.length <= 2) return
                    inputEls[inputEls.length -1].remove()
                }

                buttonsDiv = document.createElement('div')
                buttonsDiv.id = "buttons-div"
                buttonsDiv.appendChild(addLineBtn)
                buttonsDiv.appendChild(removeLineBtn)


                const randomDiv = document.createElement('div')
                randomDiv.className = "game-div"
                randomDiv.id = "random-div"

                randomDiv.appendChild(entries)
                randomDiv.appendChild(buttonsDiv)

                const randomPlay = document.createElement('button')
                randomPlay.textContent = "Play"
                randomPlay.className = "submit-btn"
                
                const randomAdd = document.createElement('button')
                randomAdd.className = "submit-btn"
                randomAdd.textContent = "Save"

                const randomSubmitDiv = document.createElement('div')
                randomSubmitDiv.id = "submit-div"
                randomSubmitDiv.appendChild(randomPlay)
                randomSubmitDiv.appendChild(randomAdd)

                console.log({obj})

                if(obj){
                    const deleteObjBtn = document.createElement('button')
                    deleteObjBtn.className = "submit-btn"
                    deleteObjBtn.textContent = "Delete"
                    randomSubmitDiv.appendChild(deleteObjBtn)

                    deleteObjBtn.addEventListener('click', (e) => {
                        deleteAreYouSure(objKey)
                        
                })

                }

                randomPlay.addEventListener('click', () => {
                    const randomObj = {}
                    let canPass = true
                    const allInputForms = entries.querySelectorAll('.input-form')

                    if(Object.keys(allInputForms).length % 2 !== 0){
                        alert('make inputs even')
                        return
                    }

                    for(let i = 0; i < allInputForms.length; i++){
                        const form = allInputForms[i]
                        const textarea = form.querySelector('textarea')
                        const imageEl = form.querySelector('img')

                        if(imageEl.src === "") {
                            alert('boş resim var')
                            canPass = false
                            return
                        }

                        randomObj[i] = {
                            img: imageEl.src,
                            text: textarea.value
                        }
                    }

                    if(!canPass) return
                    gameObj = randomObj
                    playGame(gameObj)
                })

                randomAdd.addEventListener('click', async() => {
                    const projectName = document.getElementById('game-name-input').value
                    if(projectName.trim() ===  ""){
                        alert('Project name cant be empty.'); return;
                    } 

                    const randomObj = {}
                    let canPass = true
                    const allInputForms = entries.querySelectorAll('.input-form')

                    for(let i = 0; i < allInputForms.length; i++){
                        const form = allInputForms[i]
                        const textarea = form.querySelector('textarea')
                        const imageEl = form.querySelector('img')

                        if(!imageEl.src && textarea.value.trim() === "") return

                        randomObj[i] = {
                            img: imageEl.src || "",
                            text: textarea.value
                        }
                    }

                    const newObj = {
                        name: projectName,
                        obj: randomObj,
                        mode: "Random"
                    }

                    if(obj){
                        await setProject(objKey, newObj)
                    }else{
                        await setProject(giveUniqeId(),newObj)
                    }

                    alert('Project Saved')
                    showProjects()
                    
                })
                randomDiv.appendChild(randomSubmitDiv)
                gameScreen.append(randomDiv)
                    
            }

            function manuelMenu(obj,objKey){
                const randomBtn = document.getElementsByClassName('game-type')
                if(randomBtn.length){
                    randomBtn[1].style.outline = 'none'
                    randomBtn[0].style.outline = "2px solid rgb(233,217,211)"
                }
                
                const randomDiv = document.getElementById('random-div')
                randomDiv && randomDiv.remove()
                const manuel = document.getElementById('manuel-div')
                if(manuel) return
                    entries.style.display = "flex"
                    entries.innerHTML = ""

                if(obj){
                    Object.entries(obj).forEach(([key,value]) => entries.appendChild(createRivalEl(obj[key])))
                }else{
                    entries.appendChild(createRivalEl())
                }

                    function createRivalEl(obj){
                        if(obj){
                            const rivalsDiv = document.createElement('div')
                            rivalsDiv.className = "rivals-element"
                            Object.entries(obj).forEach(([key,value]) => {
                                rivalsDiv.appendChild(createInputForm(obj[key]))
                            })
                            return rivalsDiv
                        }else{
                            const rivalsDiv = document.createElement('div')
                            rivalsDiv.className = "rivals-element"

                            const bracet = document.createElement('div')
                            bracet.className = 'bracet'

                            rivalsDiv.appendChild(createInputForm())
                            rivalsDiv.appendChild(bracet)
                            rivalsDiv.appendChild(createInputForm())

                            return rivalsDiv
                        }
                        
                    }

                   

                    const addRivalsBtn = document.createElement('button')
                    addRivalsBtn.textContent = "Add Rivals"
                    addRivalsBtn.className = "add-btn"
                    addRivalsBtn.onclick = () =>  entries.appendChild(createRivalEl())

                    const removeRivalsBtn = document.createElement('button')
                    removeRivalsBtn.textContent = "Remove Rivals"
                    removeRivalsBtn.className = "remove-btn"
                    removeRivalsBtn.onclick = () => {
                        const allRivals = entries.querySelectorAll('.rivals-element')
                        if(allRivals.length <= 1) return
                        allRivals[allRivals.length-1].remove()
                    }

                    buttonsDiv = document.createElement('div')
                    buttonsDiv.id = "buttons-div"
                    buttonsDiv.appendChild(addRivalsBtn)
                    buttonsDiv.appendChild(removeRivalsBtn)

                    const manuelDiv = document.createElement('div')
                    manuelDiv.className = "game-div"
                    manuelDiv.id = "manuel-div"

                    manuelDiv.appendChild(entries)
                    manuelDiv.appendChild(buttonsDiv)

                    const manuelPlay = document.createElement('button')
                    manuelPlay.className = "submit-btn"
                    manuelPlay.textContent = "Play"

                    const manuelAdd = document.createElement('button')
                    manuelAdd.className = "submit-btn"
                    manuelAdd.textContent = "Save"

                    const manuelSubmitDiv= document.createElement('div')
                    manuelSubmitDiv.id = "submit-div"

                    manuelSubmitDiv.appendChild(manuelPlay)
                    manuelSubmitDiv.appendChild(manuelAdd)

                    if(obj){
                        console.log({obj})
                        const deleteObjBtn = document.createElement('button')
                        deleteObjBtn.className = "submit-btn"
                        deleteObjBtn.textContent = "Delete"
                        manuelSubmitDiv.appendChild(deleteObjBtn)

                        deleteObjBtn.addEventListener('click', (e) => {
                            const modal = document.createElement('div')
                            modal.id = "exit-modal"
                            
                            const modalText =document.createElement('p')
                            modalText.id = "exit-text"
                            modalText.textContent = "Are you sure to delete this project ? "

                            const buttonsDiv = document.createElement('div')
                            buttonsDiv.id = "exit-modal-buttons-div"

                            const yesBtn = document.createElement('button')
                            yesBtn.textContent = "Delete"
                            const noBtn = document.createElement('button')
                            noBtn.textContent = "Stay"

                            yesBtn.addEventListener('click', async() => {

                                await deleteProject(objKey)

                                modal.remove()
                                showProjects()
                            })

                            noBtn.addEventListener('click', () => {
                                modal.remove()
                            })

                            buttonsDiv.appendChild(yesBtn)
                            buttonsDiv.appendChild(noBtn)

                            modal.appendChild(modalText)
                            modal.appendChild(buttonsDiv)

                            screen.appendChild(modal)
                        })

                    }

                    
                    manuelPlay.addEventListener('click', () => {
                        const manObj = {}
                        let canPass = true
                        const allRivals = entries.querySelectorAll('.rivals-element')
                        
                        for(let i = 0; i < allRivals.length; i++){
                            const rivalEl = allRivals[i]
                            const allForms = rivalEl.querySelectorAll('.input-form')

                            let targetIndex1;
                            let targetIndex2;

                            let obj1;
                            let obj2;

                            for(let j = 0; j < allForms.length; j++){
                                const form = allForms[j]
                                const textarea = form.querySelector('textarea')
                                const imageEl = form.querySelector('img')

                                if(j % 2 === 0){
                                    targetIndex1 = (i * 2)
                                }else if(j % 2 === 1){
                                    targetIndex2 = (i * 2) + 1
                                }

                                if(!manObj[i]) manObj[i] = {}

                                if(targetIndex2){
                                    obj2 = {
                                        img: imageEl.src,
                                        text: textarea.value
                                    }
                                    manObj[i][targetIndex1] = obj1
                                    manObj[i][targetIndex2] = obj2

                                }else if(targetIndex1 || targetIndex1 === 0){
                                    obj1 = {
                                        img: imageEl.src,
                                        text: textarea.value
                                    }
                                }

                            }
                        }
                       
                        if(!canPass) return
                        gameObj = manObj
                        playGame(gameObj)
                        
                    })

                    manuelAdd.addEventListener('click', async() => {
                        const projectName = document.getElementById('game-name-input').value
                        if(projectName.trim() ===  "") {
                            alert('Project name cant be empty.'); return;
                        } 

                        const manObj = {}
                        let canPass = true
                        const allRivals = entries.querySelectorAll('.rivals-element')

                        for(let i = 0; i < allRivals.length; i++){
                            const rivalEl = allRivals[i]
                            const allForms = rivalEl.querySelectorAll('.input-form')

                            let targetIndex1;
                            let targetIndex2;

                            let obj1;
                            let obj2;

                            for(let j = 0; j < allForms.length; j++){
                                const form = allForms[j]
                                const textarea = form.querySelector('textarea')
                                const imageEl = form.querySelector('img')

                                if(j % 2 === 0){
                                    targetIndex1 = (i * 2)
                                }else if(j % 2 === 1){
                                    targetIndex2 = (i * 2) + 1
                                }

                                if(!manObj[i]) manObj[i] = {}

                                if(targetIndex2){
                                    obj2 = {
                                        img: imageEl.src,
                                        text: textarea.value
                                    }
                                    manObj[i][targetIndex1] = obj1
                                    manObj[i][targetIndex2] = obj2


                                }else if(targetIndex1 || targetIndex1 === 0){
                                    obj1 = {
                                        img: imageEl.src,
                                        text: textarea.value
                                    }
                                }

                            }
                        }

                        const newObj = {
                            name: projectName,
                            obj: manObj,
                            mode: "Manuel"
                        }

                        if(obj){
                            await setProject(objKey, newObj)
                        }else{
                            await setProject(giveUniqeId(),newObj)
                        }

                        alert('Project Saved')
                        showProjects()
                        
                    })
                        
                    manuelDiv.appendChild(manuelSubmitDiv)
                    gameScreen.append(manuelDiv)
            }
            gameTypeSelectionDiv.addEventListener('click', (e) => {
                let gameType;
                if(e.target.tagName === "P"){
                    gameType = e.target.innerText
                } 
                else if(e.target.className === "game-type"){
                    gameType = e.target.querySelector('p').textContent
                }

                let buttonsDiv;
                switch (gameType) {
                    case "Random": randomMenu(); break;
                    case "Manuel": manuelMenu(); break;
                    default:break;
                }
            })


            async function blobUrlToBase64(blobUrl) {
                // Blob'u çek
                const res = await fetch(blobUrl);
                const blob = await res.blob();

                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onloadend = () => resolve(reader.result);  // dataURL (base64)
                    reader.readAsDataURL(blob);
                });
            }

        }

        async function playGame(gameObj){
            gameState = "play"
            game.remove()
            menu.style.display = "none"
            if(!Object.keys(gameObj).length) return

            const exitDiv = document.createElement('div')

            exitDiv.id = "exit"
            exitDiv.title = "End Game"
            const exitSvg = `
            <svg xmlns="http://www.w3.org/2000/svg" width="3em" height="3em" viewBox="0 0 24 24">
                <path fill="none" d="M0 0h24v24H0V0z"></path>
                <path id="exit-btn-color" fill="rgb(237, 228, 228)" d="M10.79 16.29c.39.39 1.02.39 1.41 0l3.59-3.59c.39-.39.39-1.02 0-1.41L12.2 7.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L12.67 11H4c-.55 0-1 .45-1 1s.45 1 1 1h8.67l-1.88 1.88c-.39.39-.38 1.03 0 1.41zM19 3H5c-1.11 0-2 .9-2 2v3c0 .55.45 1 1 1s1-.45 1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1v3c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path>
            </svg>
            `
            exitDiv.innerHTML = exitSvg
            fluHeaderDiv.appendChild(exitDiv)

            exitDiv.addEventListener('click', () => {
                if(gameState === "done"){
                    exitDiv.remove()
                    playDiv.remove()
                    menu.style.display = "flex"
                    return
                }
                const modal = document.createElement('div')
                modal.id = "exit-modal"
                
                const modalText =document.createElement('p')
                modalText.id = "exit-text"
                modalText.textContent = "Are you sure to leave ? "

                const buttonsDiv = document.createElement('div')
                buttonsDiv.id = "exit-modal-buttons-div"

                const yesBtn = document.createElement('button')
                yesBtn.textContent = "Leave"
                const noBtn = document.createElement('button')
                noBtn.textContent = "Stay"

                yesBtn.addEventListener('click', () => {
                    modal.remove()
                    playDiv.remove()
                    menu.style.display = "flex"
                    exitDiv.remove()
                })

                noBtn.addEventListener('click', () => {
                    modal.remove()
                })

                buttonsDiv.appendChild(yesBtn)
                buttonsDiv.appendChild(noBtn)

                modal.appendChild(modalText)
                modal.appendChild(buttonsDiv)

                screen.appendChild(modal)
            })  

            const playDiv = document.createElement('div')
            playDiv.id = "play"
            const playScreenDiv = document.createElement('div')
            playScreenDiv.id = "play-screen"

            playDiv.appendChild(playScreenDiv)
            screen.appendChild(playDiv)

            let newObj = {}

            if(!gameObj[0]?.[0]) {
                newObj = makeRivals(gameObj)
            }else{
                newObj = gameObj
            }

            let winner;
            while (!winner) {
                for(const [i,obj] of Object.entries(newObj)){
                    playDiv.innerHTML = ""
                    await new Promise(resolve => {
                        Object.entries(obj).forEach(([key,value]) => {
                            const selection = document.createElement('div') 
                            selection.className = "selection"
                            selection.id = key

                            const selectionImgDiv = document.createElement('div')
                            selectionImgDiv.className = "selection-img"
                            const selectionImg = document.createElement('img')
                            selectionImg.src = value.img
                            selectionImgDiv.appendChild(selectionImg)

                            const selectionTextDiv = document.createElement('div')
                            selectionTextDiv.id = "selection-text-div"
                            const selectionTextPEl = document.createElement('p')
                            selectionTextPEl.innerText = value.text
                            selectionTextDiv.appendChild(selectionTextPEl)

                            selection.appendChild(selectionImgDiv)
                            selection.appendChild(selectionTextDiv)

                            playDiv.appendChild(selection)

                            selection.addEventListener('click', (e) => {
                                newObj[i] = obj[key]
                                resolve(obj[key])
                            },{once:true})
                        })
                    })

                    const isLastPair = Number(i) === Object.keys(newObj).length - 1;
                    const isWinner = Object.keys(newObj).length === 1;

                    if(isLastPair && isWinner){
                        winner = newObj[0]
                        winnerPage(winner)
                        return
                    }
                    if(isLastPair){
                        newObj = makeRivals(newObj)
                    }
                    
                }

            }
            
            function makeRivals(obj){
                let newObj = {}

                let keys = Object.keys(obj)
                const objLength = keys.length
                
                for(let i = 0; i < (objLength / 2); i++){ 
                    let obj1;

                    const index1 = randomIndex(objLength,i)
                    let isPass = false
                    let index2;
                    while(!isPass){
                        index2 = randomIndex(objLength,i)
                        if(index2 !== index1) isPass = true
                    }
                    
                    keys = keys.filter(key => !(key === index1 || key === index2))

                    newObj[i] = {
                        [i*2] : obj[index1],
                        [(i*2) + 1] : obj[index2]
                    }
                }

                return newObj

                function randomIndex(objLength,i){
                    return Math.floor(Math.random() * (objLength - i))
                }
            }
        
            function winnerPage(winner){
                playDiv.innerHTML = ""
                const winnerDiv = document.createElement('div') 
                winnerDiv.id = "winner-div"

                const selectionImgDiv = document.createElement('div')
                selectionImgDiv.className = "selection-img"
                const selectionImg = document.createElement('img')
                selectionImg.src = winner.img
                selectionImgDiv.appendChild(selectionImg)

                const selectionTextDiv = document.createElement('div')
                selectionTextDiv.id = "winner-text-div"
                const selectionTextPEl = document.createElement('p')
                selectionTextPEl.innerText = winner.text
                selectionTextDiv.appendChild(selectionTextPEl)

                const winnerImg = document.createElement('div')
                winnerImg.id = "winner-img-div"

                winnerImg.appendChild(selectionImgDiv)
                winnerImg.appendChild(selectionTextDiv)

                const winnerHeaderDiv = document.createElement('div')
                winnerHeaderDiv.id = "winner-header-div"
                const winnerHeaderText = document.createElement('p')
                winnerHeaderText.id = "winner-header-text"
                winnerHeaderText.textContent = "! WINNER !"

                winnerHeaderDiv.appendChild(winnerHeaderText)

                gameState = "done"
                winnerDiv.appendChild(winnerHeaderDiv)
                winnerDiv.appendChild(winnerImg)

                playDiv.appendChild(winnerDiv)

                const particles = ['⭐', '✨', '💫', '🌟', '⚡', '🔥', '💥', '🎨'];
                let interval;

                function launchFirework() {

                    const width = winnerDiv.offsetWidth || window.innerWidth;
                    const height = winnerDiv.offsetHeight || window.innerHeight;

                    // Random pozisyon
                    const x = Math.random() * width;
                    const y = Math.random() * (height * 0.7) + (height * 0.15);
                    
                    // Her havai fişek için 20-30 parçacık
                    const particleCount = Math.floor(Math.random() * 10) + 20;
                    
                    for (let i = 0; i < particleCount; i++) {
                        createParticle(x, y);
                    }
                }

                function createParticle(startX, startY) {
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.pointerEvents = 'none';
                    particle.style.zIndex = '1000';
                    
                    // Random emoji seç
                    const emoji = particles[Math.floor(Math.random() * particles.length)];
                    particle.innerHTML = emoji;
                    particle.style.fontSize = (Math.random() * 20 + 20) + 'px';
                    
                    // Başlangıç pozisyonu
                    particle.style.left = startX + 'px';
                    particle.style.top = startY + 'px';
                    
                    winnerDiv.appendChild(particle);
                    
                    // Random yön ve hız
                    const angle = Math.random() * Math.PI * 2;
                    const velocity = Math.random() * 200 + 100;
                    const velocityX = Math.cos(angle) * velocity;
                    const velocityY = Math.sin(angle) * velocity;
                    
                    // Animasyon parametreleri
                    let currentX = startX;
                    let currentY = startY;
                    let currentVelocityX = velocityX;
                    let currentVelocityY = velocityY;
                    let opacity = 1;
                    let rotation = 0;
                    
                    const gravity = 300;
                    const fadeSpeed = 0.015;
                    let startTime = Date.now();
                    
                    function animate() {
                        const currentTime = Date.now();
                        const deltaTime = (currentTime - startTime) / 1000;
                        startTime = currentTime;
                        
                        // Fizik hesaplamaları
                        currentVelocityY += gravity * deltaTime;
                        currentX += currentVelocityX * deltaTime;
                        currentY += currentVelocityY * deltaTime;
                        
                        // Rotasyon
                        rotation += 360 * deltaTime;
                        
                        // Opacity azalt
                        opacity -= fadeSpeed;
                        
                        // Pozisyonu güncelle
                        particle.style.left = currentX + 'px';
                        particle.style.top = currentY + 'px';
                        particle.style.opacity = opacity;
                        particle.style.transform = `rotate(${rotation}deg)`;
                        
                        // Animasyon devam et veya sil
                        if (opacity > 0 && currentY < winnerDiv.offsetHeight) {
                            requestAnimationFrame(animate);
                        } else {
                            particle.remove();
                        }
                    }
                    
                    animate();
                }
                
                setTimeout(() => {
                    launchFirework();
                    
                    interval = setInterval(() => {
                        launchFirework();
                    }, 2000);
                    
                    setTimeout(() => launchFirework(), 500);
                    setTimeout(() => launchFirework(), 1000);
                }, 100);

                return () => interval && clearInterval(interval)
            }
        }

        function giveUniqeId(){
            const date = new Date()

            const hour = date.getHours();
            const minute = date.getMinutes();
            const seconds = date.getSeconds();
            const day = date.getDate();
            const month = date.getMonth() + 1; // Aylar 0–11 olduğu için +1
            const year = date.getFullYear();

            return `${day}-${month}-${year}-${hour}-${minute}-${seconds}`
        }
        
        function openDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open("projectsDb", 1);

                request.onupgradeneeded = function (e) {
                    const db = e.target.result;

                    if (!db.objectStoreNames.contains("projects")) {
                        db.createObjectStore("projects");
                    }
                };

                request.onsuccess = e => resolve(e.target.result);
                request.onerror = e => reject(e);
            });
        }

        async function setProject(key, value) {
            const db = await openDB();
            const tx = db.transaction("projects", "readwrite");
            const store = tx.objectStore("projects");

            store.put(value, key); 

            return tx.complete;
        }

        async function getProject(key) {
            const db = await openDB();
            const tx = db.transaction("projects", "readonly");
            const store = tx.objectStore("projects");

            return new Promise(res => {
                const req = store.get(key);
                req.onsuccess = () => res(req.result);
            });
        }

        async function getProjectsAsObject() {
            const db = await openDB();
            const tx = db.transaction("projects", "readonly");
            const store = tx.objectStore("projects");

            return new Promise(res => {
                const items = {};
                const req = store.openCursor();
                req.onsuccess = () => {
                    const cursor = req.result;
                    if (cursor) {
                        items[cursor.key] = cursor.value;
                        cursor.continue();
                    } else {
                        res(items);
                    }
                };
            });
        }

        async function deleteProject(key) {
            const db = await openDB();
            const tx = db.transaction("projects", "readwrite");
            const store = tx.objectStore("projects");

            store.delete(key);

            return tx.complete;
        }

        function deleteAreYouSure(objKey){
            const modal = document.createElement('div')
            modal.id = "exit-modal"
            
            const modalText =document.createElement('p')
            modalText.id = "exit-text"
            modalText.textContent = "Are you sure to delete this project ? "

            const buttonsDiv = document.createElement('div')
            buttonsDiv.id = "exit-modal-buttons-div"

            const yesBtn = document.createElement('button')
            yesBtn.textContent = "Delete"
            const noBtn = document.createElement('button')
            noBtn.textContent = "Stay"

            yesBtn.addEventListener('click', async() => {
                await deleteProject(objKey)

                modal.remove()
                showProjects()
            })

            noBtn.addEventListener('click', () => {
                modal.remove()
            })

            buttonsDiv.appendChild(yesBtn)
            buttonsDiv.appendChild(noBtn)

            modal.appendChild(modalText)
            modal.appendChild(buttonsDiv)

            screen.appendChild(modal)
        }
                    
    </script>
</body>
</html>